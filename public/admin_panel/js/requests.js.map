{"version":3,"sources":["requests.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"requests.js","sourcesContent":["function load_datatable(ajax_url) {\n    $('#table').DataTable( {\n        dom: \"<'row' <'col-md-12'B>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>\",\n        ajax : ajax_url,\n        buttons: [\n            { extend: 'print', className: 'btn dark btn-outline', exportOptions: { columns: [ 0, 1, 3, 4, 5, 6, 7, 8, 9 ] } },\n            { extend: 'copy', className: 'btn red btn-outline', exportOptions: { columns: [ 0, 1, 3, 4, 5, 6, 7, 8, 9 ] } },\n            { extend: 'pdf', className: 'btn green btn-outline', exportOptions: { columns: [ 0, 1, 3, 4, 5, 6, 7, 8, 9 ] } },\n            { extend: 'excel', className: 'btn yellow btn-outline', exportOptions: { columns: [ 0, 1, 3, 4, 5, 6, 7, 8, 9 ] } },\n            { extend: 'csv', className: 'btn purple btn-outline', exportOptions: { columns: [ 0, 1, 3, 4, 5, 6, 7, 8, 9 ] } },\n        ],\n        lengthMenu: [\n            [5, 10, 15, 20, -1],\n            [5, 10, 15, 20, \"All\"]\n        ],\n        pageLength: 10,\n        // responsive: {\n        //     details: {\n        //\n        //     }\n        // },\n        columnDefs: [\n            { responsivePriority: 1, targets: 0 },\n            { responsivePriority: 2, targets: -1 }\n        ],\n        language: {\n            \"aria\": {\n                \"sortAscending\": \": activate to sort column ascending\",\n                \"sortDescending\": \": activate to sort column descending\"\n            },\n            \"emptyTable\": \"No data available in table\",\n            \"info\": \"Showing _START_ to _END_ of _TOTAL_ entries\",\n            \"infoEmpty\": \"No entries found\",\n            \"infoFiltered\": \"(filtered1 from _MAX_ total entries)\",\n            \"lengthMenu\": \"_MENU_ entries\",\n            \"search\": \"Search:\",\n            \"zeroRecords\": \"No matching records found\"\n        },\n    });\n}\n\n$(document).ready(function () {\n    // $(\".date-picker\").datetimepicker();\n    var ajax_url = $(\"#datatable_url\").val();\n    load_datatable(ajax_url);\n\n    function canvasMerge(canvas, image, layout){\n        var canvas = document.getElementById(canvas);\n        var context = canvas.getContext('2d');\n\n        var mainImage = new Image();\n        mainImage.src = image;\n        mainImage.onload = function(){\n            context.drawImage(mainImage,\n                0, 0,\n                800, 500\n            );\n            var overlayImage = new Image();\n            overlayImage.src = layout;\n            overlayImage.onload = function(){\n                context.drawImage(overlayImage,\n                    0, 0,\n                    800, 500\n                );\n            }\n        }\n    }\n\n    $('body').on('click', '.view-detail', function () {\n        var jsdata = $(this).siblings('.jsdata');\n        var form   = $(\"#change_status_form\");\n        var image  = jsdata.data('image');\n        var name   = jsdata.data('name');\n        $(\".modal-footer\").hide();\n        $(\".request-image\").attr(\"src\", image);\n        $(\".request-image\").load(function() {\n            $(\".modal-footer\").show();\n        });\n        form.children(\"input[name=request_id]\").val(jsdata.data('id'));\n        form.children(\"input[name=status]\").val(jsdata.data('status'));\n        form.children(\"a\").removeClass().addClass(\"btn btn-sm \" + jsdata.data('class')).children(\"span\")\n        .html(jsdata.data('status').replace(\"-\", \" \"));\n\n        canvasMerge(\"canvas1\", image, jsdata.data('do1'));\n        canvasMerge(\"canvas2\", image, jsdata.data('do2'));\n\n        document.getElementById('dl_button1').addEventListener('click', function() {\n            this.href = document.getElementById('canvas1').toDataURL();\n            this.download = name;\n        }, false);\n        document.getElementById('dl_button2').addEventListener('click', function() {\n            this.href = document.getElementById('canvas2').toDataURL();\n            this.download = name;\n        }, false);\n    });\n    $(\".change-status\").on(\"click\", function(){\n        var status = $(this).data('name');\n        var form = $(\"#change_status_form\");\n        form.children(\"input[name=status]\").val(status);\n        form.submit();\n    });\n    $(\"body\").on('submit', \"#change_status_form\", function(e){\n        e.preventDefault();\n        var form = $(this);\n        var formData = new FormData(this);\n        swal({\n            title: 'Are you sure?',\n            text: \"You want to change the card request status as \" + form.children(\"input[name=status]\").val() + \"!\",\n            type: 'warning',\n            showCancelButton: true,\n            confirmButtonColor: '#3085d6',\n            cancelButtonColor: '#d33',\n            confirmButtonText: 'Yes, change it!'\n        }).then(function () {\n            var request_id = form.children('input[name=request_id]').val();\n            var js_input = $(\".jsdata[data-id=\" + request_id +\"]\");\n            var row = js_input.parent().parent();\n            var action = form.children('input[name=action]').val();\n            $.ajax({\n                url: action,\n                type: \"POST\",\n                data: formData,\n                contentType: false,       // The content type used when sending data to the server.\n                cache: false,             // To unable request pages to be cached\n                processData:false,        // To send DOMDocument or non processed data file it is set to false\n            }).done(function(data){\n                if(data.success) {\n                    form.children(\"a\").removeClass()\n                    .addClass(\"btn btn-sm \" + data.class)\n                    .children(\"span\").html(data.title);\n                    js_input.data('class', data.class);\n                    js_input.data('status', data.status);\n                    row.find(\".request-status\")\n                    .removeClass().addClass(\"label \"+data.class)\n                    .html(data.status);\n                    swal(\n                        'Changed!',\n                        'Request is now ' + data.title,\n                        'success'\n                    );\n                }else {\n                    swal(\n                        'Not changed!',\n                        data.message,\n                        'warning'\n                    );\n                }\n            }).fail(function(){\n                swal(\n                    'Failed!',\n                    'Status changed request failed.',\n                    'error'\n                );\n            });\n        }, function (dismiss) {\n            if (dismiss === 'cancel') {\n                swal(\n                    'Cancelled',\n                    'Your change request cancelled.',\n                    'error'\n                )\n            }\n        });\n    });\n});\n"],"sourceRoot":"/source/"}